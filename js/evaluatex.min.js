!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={fact:t.fact=function(e){var t=1;if((e=Math.round(e))<0)throw"Can't factorial a negative.";for(;e>1;e--)t*=e;return t},frac:t.frac=function(e,t){return e/t},logn:t.logn=function(e,t){return Math.log(e)/Math.log(t)},rootn:t.rootn=function(e,t){return Math.pow(e,1/t)},sec:t.sec=function(e){return 1/Math.cos(e)},csc:t.csc=function(e){return 1/Math.sin(e)},cot:t.cot=function(e){return 1/Math.tan(e)}},i=!0,a=!1,u=void 0;try{for(var o,s=Object.getOwnPropertyNames(Math)[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;r[l]=Math[l]}}catch(e){a=!0,u=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw u}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={frac:2,sqrt:1,sin:1,cos:1,tan:1,asin:1,acos:1,atan:1,sec:1,csc:1,cot:1,asec:1,acsc:1,acot:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.value=n,this.name=null}return r(e,[{key:"equals",value:function(e){return this.type===e.type&&this.value===e.value}},{key:"toString",value:function(){if(a.indexOf(this.type)>=0)return this.type;var e="function"==typeof this.value?this.name:this.value;return this.type+"["+e+"]"}}]),e}();i.TYPE_LPAREN="LPAREN",i.TYPE_RPAREN="RPAREN",i.TYPE_PLUS="PLUS",i.TYPE_MINUS="MINUS",i.TYPE_TIMES="TIMES",i.TYPE_DIVIDE="DIVIDE",i.TYPE_COMMAND="COMMAND",i.TYPE_SYMBOL="SYMBOL",i.TYPE_WHITESPACE="WHITESPACE",i.TYPE_ABS="ABSOLUTEVAL",i.TYPE_BANG="BANG",i.TYPE_COMMA="COMMA",i.TYPE_POWER="POWER",i.TYPE_NUMBER="NUMBER",i.patterns=new Map([[i.TYPE_LPAREN,/(\(|\[|{|\\left\(|\\left\[)/],[i.TYPE_RPAREN,/(\)|]|}|\\right\)|\\right])/],[i.TYPE_PLUS,/\+/],[i.TYPE_MINUS,/-/],[i.TYPE_TIMES,/\*/],[i.TYPE_DIVIDE,/\//],[i.TYPE_COMMAND,/\\[A-Za-z]+/],[i.TYPE_SYMBOL,/[A-Za-z_][A-Za-z_0-9]*/],[i.TYPE_WHITESPACE,/\s+/],[i.TYPE_ABS,/\|/],[i.TYPE_BANG,/!/],[i.TYPE_COMMA,/,/],[i.TYPE_POWER,/\^/],[i.TYPE_NUMBER,/\d+(\.\d+)?/]]),t.default=i;var a=["TPLUS","TMINUS","TTIMES","TDIVIDE","TWS","TABS","TBANG","TCOMMA","TPOWER"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a={sum:function(e,t){return e+t},product:function(e,t){return e*t},power:function(e,t){return Math.pow(e,t)},inverse:function(e){return 1/e},number:function(e){return e}},u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.value=n,this.name=null,this.children=[],this.options=r||{}}return i(e,[{key:"addChild",value:function(e){return this.children.push(e),this}},{key:"evaluate",value:function(t){var n=0,i=r({},a,this.options.operations);switch(this.type){case e.TYPE_FUNCTION:var u=this.children.map(function(e){return e.evaluate(t)});n=(i[this.name]||this.value).apply(this,u);break;case e.TYPE_INVERSE:n=i.inverse(this.child.evaluate(t));break;case e.TYPE_NEGATE:n=i.negate(this.child.evaluate(t));break;case e.TYPE_NUMBER:n=i.number(this.value);break;case e.TYPE_POWER:n=i.power(this.children[0].evaluate(t),this.children[1].evaluate(t));break;case e.TYPE_PRODUCT:n=this.children.reduce(function(e,n){return i.product(e,n.evaluate(t))},1);break;case e.TYPE_SUM:n=this.children.reduce(function(e,n){return i.sum(e,n.evaluate(t))},0);break;case e.TYPE_SYMBOL:var o=t[this.value];if(isFinite(t[this.value]))return t[this.value];if(i.isNumber&&i.isNumber(o))return o;throw"Symbol "+this.value+" is undefined or not a number"}return n}},{key:"isUnary",value:function(){return o.indexOf(this.type)>=0}},{key:"printTree",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t="",n=0;n<e;n++)t+="  ";for(var r in console.log(t+this.toString()),this.children)this.children[r].printTree(e+1)}},{key:"simplify",value:function(){if(this.children.length>1||this.isUnary()){var t=new e(this.type,this.value,this.options);for(var n in t.name=this.name,this.children)t.addChild(this.children[n].simplify());return t}return 1===this.children.length?this.children[0].simplify():this}},{key:"toString",value:function(){var e="function"==typeof this.value?this.name:this.value;return this.children.length+" "+this.type+" ["+e+"]"}},{key:"child",get:function(){return this.children[0]}},{key:"nodeCount",get:function(){var e=1,t=!0,n=!1,r=void 0;try{for(var i,a=this.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){e+=i.value.nodeCount}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return e}}]),e}();u.TYPE_FUNCTION="FUNCTION",u.TYPE_INVERSE="INVERSE",u.TYPE_NEGATE="NEGATE",u.TYPE_NUMBER="NUMBER",u.TYPE_POWER="POWER",u.TYPE_PRODUCT="PRODUCT",u.TYPE_SUM="SUM",u.TYPE_SYMBOL="SYMBOL",t.default=u;var o=["FACTORIAL","FUNCTION","INVERSE","NEGATE"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e,t){return new l(e,t).parse()};var i=s(n(3)),a=s(n(2)),u=s(n(1)),o=n(0);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cursor=0,this.tokens=t,this.options=n;var r=n.operations;this.nodeOptions={operations:r}}return r(e,[{key:"parse",value:function(){var e=this.sum();if(e=e.simplify(),void 0!==this.currentToken)throw console.log(e.printTree()),"Parsing error: Expected end of input, but got "+this.currentToken.type+" "+this.currentToken.value;return e}},{key:"accept",value:function(e){return!(!this.currentToken||this.currentToken.type!==e)&&(this.cursor++,!0)}},{key:"expect",value:function(e){if(!this.accept(e))throw"Expected "+e+" but got "+(this.currentToken?this.currentToken.toString():"end of input.")}},{key:"sum",value:function(){var e=new i.default(i.default.TYPE_SUM,"",this.nodeOptions);for(e.addChild(this.product());;)if(this.accept(a.default.TYPE_PLUS))e.addChild(this.product());else{if(!this.accept(a.default.TYPE_MINUS))break;e.addChild(new i.default(i.default.TYPE_NEGATE,"",this.nodeOptions).addChild(this.product()))}return e}},{key:"product",value:function(){var e=new i.default(i.default.TYPE_PRODUCT,"",this.nodeOptions);for(e.addChild(this.power());;)if(this.accept(a.default.TYPE_TIMES))e.addChild(this.power());else if(this.accept(a.default.TYPE_DIVIDE))e.addChild(new i.default(i.default.TYPE_INVERSE,"",this.nodeOptions).addChild(this.power()));else if(this.accept(a.default.TYPE_LPAREN))this.cursor--,e.addChild(this.power());else{if(!(this.accept(a.default.TYPE_SYMBOL)||this.accept(a.default.TYPE_NUMBER)||this.accept(a.default.TYPE_FUNCTION)))break;this.cursor--,e.addChild(this.power())}return e}},{key:"power",value:function(){var e=new i.default(i.default.TYPE_POWER,"",this.nodeOptions);return e.addChild(this.val()),this.accept(a.default.TYPE_POWER)&&e.addChild(this.power()),e}},{key:"val",value:function(){var e={};if(this.accept(a.default.TYPE_SYMBOL))e=new i.default(i.default.TYPE_SYMBOL,this.prevToken.value,this.nodeOptions);else if(this.accept(a.default.TYPE_NUMBER))e=new i.default(i.default.TYPE_NUMBER,parseFloat(this.prevToken.value),this.nodeOptions);else if(this.accept(a.default.TYPE_COMMAND)){var t=this.prevToken;(e=new i.default(i.default.TYPE_FUNCTION,t.value,this.nodeOptions)).name=t.name;for(var n=0;n<u.default[t.name];n++)e.addChild(this.val())}else if(this.accept(a.default.TYPE_FUNCTION))if((e=new i.default(i.default.TYPE_FUNCTION,this.prevToken.value,this.nodeOptions)).name=this.prevToken.name,this.accept(a.default.TYPE_LPAREN)){for(e.addChild(this.sum());this.accept(a.default.TYPE_COMMA);)e.addChild(this.sum());this.expect(a.default.TYPE_RPAREN)}else e.addChild(this.power());else if(this.accept(a.default.TYPE_MINUS))e=new i.default(i.default.TYPE_NEGATE,"",this.nodeOptions).addChild(this.power());else if(this.accept(a.default.TYPE_LPAREN))e=this.sum(),this.expect(a.default.TYPE_RPAREN);else{if(!this.accept(a.default.TYPE_ABS))throw"Unexpected "+this.currentToken.toString()+" at token "+this.cursor;(e=new i.default(i.default.TYPE_FUNCTION,Math.abs,this.nodeOptions)).addChild(this.sum()),this.expect(a.default.TYPE_ABS)}if(this.accept(a.default.TYPE_BANG)){var r=new i.default(i.default.TYPE_FUNCTION,o.fact,this.nodeOptions);return r.addChild(e),r}return e}},{key:"currentToken",get:function(){return this.tokens[this.cursor]}},{key:"prevToken",get:function(){return this.tokens[this.cursor-1]}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var u,o=e[Symbol.iterator]();!(r=(u=o.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c,r=new f(e,t,n);return r.lex(),r.tokens.toString=function(){return r.tokens.map(function(e){return e.toString()}).join(" ")},r.tokens};var a=s(n(2)),u=s(n(1)),o=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var l=[a.default.TYPE_POWER,a.default.TYPE_COMMAND],c={latex:!1};var f=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.buffer=t,this.constants=Object.assign({},n,o.default),this.opts=r,this.tokens=[]}return i(e,[{key:"lex",value:function(){this.lexExpression(),this.replaceConstants(),this.replaceCommands()}},{key:"lexExpression",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hasNext();){var t=e?this.nextCharToken():this.next();if(this.tokens.push(t),this.opts.latex&&h(t)){var n=1;t.type===a.default.TYPE_COMMAND&&(n=u.default[t.value.substr(1).toLowerCase()]);for(var r=0;r<n;r++)this.lexExpression(!0)}else d(t)&&this.lexExpression(!1);if(e||v(t))return}}},{key:"hasNext",value:function(){return this.buffer.length>0}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this.skipWhitespace(),!this.hasNext())throw"Lexer error: reached end of stream";var t=!0,n=!1,i=void 0;try{for(var u,o=a.default.patterns[Symbol.iterator]();!(t=(u=o.next()).done);t=!0){var s=u.value,l=r(s,2),c=l[0],f=l[1],h=new RegExp(/^/.source+f.source).exec(this.buffer.substr(0,e));if(h)return this.buffer=this.buffer.substr(h[0].length),new a.default(c,h[0])}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}throw"Lexer error: can't match any token"}},{key:"nextCharToken",value:function(){return this.skipWhitespace(),"\\"===this.buffer.charAt(0)?this.next():this.next(1)}},{key:"replaceCommands",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.tokens[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var u=r.value;u.type===a.default.TYPE_COMMAND&&(u.value=u.value.substr(1).toLowerCase(),u.name=u.value,u.value=this.constants[u.name])}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"replaceConstants",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.tokens[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var u=r.value;u.type===a.default.TYPE_SYMBOL&&("function"==typeof this.constants[u.value]?(u.type=a.default.TYPE_FUNCTION,u.name=u.value,u.value=this.constants[u.value],console.log("replace token",u.name)):"number"==typeof this.constants[u.value]&&(u.type=a.default.TYPE_NUMBER,u.value=u.fn=this.constants[u.value]))}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"skipWhitespace",value:function(){var e=new RegExp(/^/.source+a.default.patterns.get(a.default.TYPE_WHITESPACE).source);this.buffer=this.buffer.replace(e,"")}}]),e}();function h(e){return-1!==l.indexOf(e.type)}function d(e){return e.type===a.default.TYPE_LPAREN&&"{"===e.value}function v(e){return e.type===a.default.TYPE_RPAREN&&"}"===e.value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,r.default)(e,t,n),u=(0,i.default)(a,n).simplify(),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u.evaluate(e)};return o.ast=u,o.expression=e,o.tokens=a,o};var r=a(n(5)),i=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";window.evaluatex=n(6).default}]);